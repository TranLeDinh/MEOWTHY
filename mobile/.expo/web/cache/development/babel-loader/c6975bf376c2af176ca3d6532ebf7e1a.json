{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport axios from 'axios';\nimport React, { createContext, useEffect, useState } from 'react';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar BASE_URL = \"https://meowthy-project.herokuapp.com\";\nexport var AuthContext = createContext();\nexport var AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      userInfo = _useState2[0],\n      setUserInfo = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isLoading = _useState4[0],\n      setIsLoading = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      onboardLoading = _useState6[0],\n      setonboardLoading = _useState6[1];\n\n  var login = function login(username, password) {\n    setIsLoading(true);\n    axios.post(BASE_URL + \"/user/signin\", {\n      username: username,\n      password: password\n    }).then(function (res) {\n      var userInfo = res.data;\n      console.log(userInfo);\n      setUserInfo(userInfo);\n      AsyncStorage.setItem('userInfo', JSON.stringify(userInfo));\n      setIsLoading(false);\n    }).catch(function (e) {\n      console.log(\"login error \" + e);\n      setIsLoading(false);\n    });\n  };\n\n  var isLoggedIn = function isLoggedIn() {\n    var _userInfo;\n\n    return _regeneratorRuntime.async(function isLoggedIn$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            setonboardLoading(true);\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem('userInfo'));\n\n          case 4:\n            _userInfo = _context.sent;\n            _userInfo = JSON.parse(_userInfo);\n\n            if (_userInfo) {\n              setUserInfo(_userInfo);\n            }\n\n            setonboardLoading(false);\n            _context.next = 14;\n            break;\n\n          case 10:\n            _context.prev = 10;\n            _context.t0 = _context[\"catch\"](0);\n            setonboardLoading(false);\n            console.log(\"is logged in error \" + _context.t0);\n\n          case 14:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 10]], Promise);\n  };\n\n  useEffect(function () {\n    isLoggedIn();\n  }, []);\n  return _jsx(AuthContext.Provider, {\n    value: {\n      isLoading: isLoading,\n      userInfo: userInfo,\n      onboardLoading: onboardLoading,\n      login: login\n    },\n    children: children\n  });\n};","map":{"version":3,"names":["AsyncStorage","axios","React","createContext","useEffect","useState","BASE_URL","AuthContext","AuthProvider","children","userInfo","setUserInfo","isLoading","setIsLoading","onboardLoading","setonboardLoading","login","username","password","post","then","res","data","console","log","setItem","JSON","stringify","catch","e","isLoggedIn","getItem","parse"],"sources":["D:/Nam3/Semester2/5_Mobile/app/MEOWTHY/mobile/context/AuthContext.js"],"sourcesContent":["import AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport axios from 'axios';\r\nimport React, {createContext, useEffect, useState} from 'react';\r\n\r\nconst BASE_URL=\"https://meowthy-project.herokuapp.com\";\r\nexport const AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({children}) => {\r\n  const [userInfo, setUserInfo] = useState({});\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [onboardLoading, setonboardLoading] = useState(false);\r\n/*\r\n  const register = (name, email, password) => {\r\n    setIsLoading(true);\r\n\r\n    axios\r\n      .post(`${BASE_URL}/user/signup`, {\r\n        name,\r\n        password,\r\n        \r\n      })\r\n      .then(res => {\r\n        let userInfo = res.data;\r\n        setUserInfo(userInfo);\r\n        AsyncStorage.setItem('userInfo', JSON.stringify(userInfo));\r\n        setIsLoading(false);\r\n        console.log(userInfo);\r\n      })\r\n      .catch(e => {\r\n        console.log(`register error ${e}`);\r\n        setIsLoading(false);\r\n      });\r\n  };\r\n*/\r\n  const login = (username, password) => {\r\n    setIsLoading(true);\r\n\r\n    axios\r\n      .post(`${BASE_URL}/user/signin`, {\r\n        username,\r\n        password,\r\n      })\r\n      .then(res => {\r\n        let userInfo = res.data;\r\n        console.log(userInfo);\r\n        setUserInfo(userInfo);\r\n        AsyncStorage.setItem('userInfo', JSON.stringify(userInfo));\r\n        setIsLoading(false);\r\n      })\r\n      .catch(e => {\r\n        console.log(`login error ${e}`);\r\n        setIsLoading(false);\r\n      });\r\n  };\r\n/*\r\n  const logout = () => {\r\n  };\r\n*/\r\n  const isLoggedIn = async () => {\r\n    try {\r\n      setonboardLoading(true);\r\n\r\n      let userInfo = await AsyncStorage.getItem('userInfo');\r\n      userInfo = JSON.parse(userInfo);\r\n\r\n      if (userInfo) {\r\n        setUserInfo(userInfo);\r\n      }\r\n\r\n      setonboardLoading(false);\r\n    } catch (e) {\r\n      setonboardLoading(false);\r\n      console.log(`is logged in error ${e}`);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    isLoggedIn();\r\n  }, []);\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        isLoading,\r\n        userInfo,\r\n        onboardLoading,\r\n        login,\r\n      }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};"],"mappings":";;AAAA,OAAOA,YAAP,MAAyB,2CAAzB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,IAAeC,aAAf,EAA8BC,SAA9B,EAAyCC,QAAzC,QAAwD,OAAxD;;AAEA,IAAMC,QAAQ,GAAC,uCAAf;AACA,OAAO,IAAMC,WAAW,GAAGJ,aAAa,EAAjC;AAEP,OAAO,IAAMK,YAAY,GAAG,SAAfA,YAAe,OAAgB;EAAA,IAAdC,QAAc,QAAdA,QAAc;;EAC1C,gBAAgCJ,QAAQ,CAAC,EAAD,CAAxC;EAAA;EAAA,IAAOK,QAAP;EAAA,IAAiBC,WAAjB;;EACA,iBAAkCN,QAAQ,CAAC,KAAD,CAA1C;EAAA;EAAA,IAAOO,SAAP;EAAA,IAAkBC,YAAlB;;EACA,iBAA4CR,QAAQ,CAAC,KAAD,CAApD;EAAA;EAAA,IAAOS,cAAP;EAAA,IAAuBC,iBAAvB;;EAwBA,IAAMC,KAAK,GAAG,SAARA,KAAQ,CAACC,QAAD,EAAWC,QAAX,EAAwB;IACpCL,YAAY,CAAC,IAAD,CAAZ;IAEAZ,KAAK,CACFkB,IADH,CACWb,QADX,mBACmC;MAC/BW,QAAQ,EAARA,QAD+B;MAE/BC,QAAQ,EAARA;IAF+B,CADnC,EAKGE,IALH,CAKQ,UAAAC,GAAG,EAAI;MACX,IAAIX,QAAQ,GAAGW,GAAG,CAACC,IAAnB;MACAC,OAAO,CAACC,GAAR,CAAYd,QAAZ;MACAC,WAAW,CAACD,QAAD,CAAX;MACAV,YAAY,CAACyB,OAAb,CAAqB,UAArB,EAAiCC,IAAI,CAACC,SAAL,CAAejB,QAAf,CAAjC;MACAG,YAAY,CAAC,KAAD,CAAZ;IACD,CAXH,EAYGe,KAZH,CAYS,UAAAC,CAAC,EAAI;MACVN,OAAO,CAACC,GAAR,kBAA2BK,CAA3B;MACAhB,YAAY,CAAC,KAAD,CAAZ;IACD,CAfH;EAgBD,CAnBD;;EAwBA,IAAMiB,UAAU,GAAG,SAAbA,UAAa;IAAA;;IAAA;MAAA;QAAA;UAAA;YAAA;YAEff,iBAAiB,CAAC,IAAD,CAAjB;YAFe;YAAA,iCAIMf,YAAY,CAAC+B,OAAb,CAAqB,UAArB,CAJN;;UAAA;YAIXrB,SAJW;YAKfA,SAAQ,GAAGgB,IAAI,CAACM,KAAL,CAAWtB,SAAX,CAAX;;YAEA,IAAIA,SAAJ,EAAc;cACZC,WAAW,CAACD,SAAD,CAAX;YACD;;YAEDK,iBAAiB,CAAC,KAAD,CAAjB;YAXe;YAAA;;UAAA;YAAA;YAAA;YAafA,iBAAiB,CAAC,KAAD,CAAjB;YACAQ,OAAO,CAACC,GAAR;;UAde;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAnB;;EAkBApB,SAAS,CAAC,YAAM;IACd0B,UAAU;EACX,CAFQ,EAEN,EAFM,CAAT;EAIA,OACE,KAAC,WAAD,CAAa,QAAb;IACE,KAAK,EAAE;MACLlB,SAAS,EAATA,SADK;MAELF,QAAQ,EAARA,QAFK;MAGLI,cAAc,EAAdA,cAHK;MAILE,KAAK,EAALA;IAJK,CADT;IAAA,UAOGP;EAPH,EADF;AAWD,CApFM"},"metadata":{},"sourceType":"module"}